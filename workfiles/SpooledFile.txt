








 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      1

  Command  . . . . . . . . . . . . :   CRTBNDRPG
    Issued by  . . . . . . . . . . :     VZUPKA
  Program  . . . . . . . . . . . . :   RGHS_ENT
    Library  . . . . . . . . . . . :     VZRPG_FREE
  Text 'description' . . . . . . . :   *SRCMBRTXT
  Source stream file   . . . . . . :   /home/VZRPG72/RGHS_ENT.MBR
    CCSID  . . . . . . . . . . . . :     37
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   08/29/17  11:05:57

  Generation severity level  . . . :   10
  Default activation group . . . . :   *YES
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *NOEVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *NONE
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *HEX
  Language identifier  . . . . . . :   *JOBRUN
  Replace program  . . . . . . . . :   *YES
  User profile . . . . . . . . . . :   *USER
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   *CURRENT
  Allow null values  . . . . . . . :   *NO
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :
  Preprocessor options . . . . . . :   *NONE



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      2

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number

                          S o u r c e   L i s t i n g

     1  **********************************************************************                                              000001
     2  *                                                                                                                   000002
     3  *                                                                                                                   000003
     4  **********************************************************************                                              000004
     5  *=====================================================================                                              000005
     6  *   File descriptions                                                                                               000006
     7  *=====================================================================                                              000007
     8                                                                                                                      000008
     9  *   filter file                                                                                                     000009


    10 fPFHS_ENT  uf a e           k disk    usropn                                                        _MOD             000010
    11  *   display file                                                                                                    000011
*RNF2120 40     10 000010  External descriptions for file PFHS_ENT not found; file is
                           ignored.
    12 fDFHS_ENT  cf   e             workstn sfile(HSTSF : idxSfl)                                         _MOD             000012
======> aaaaaaaa
*RNF2120 40 a      000012  External descriptions for file DFHS_ENT not found; file is
                           ignored.
    13                                                                                                                      000013
    14  *   field descriptions of filter file                                                                               000014
    15 fQADSPFFD  if   e             disk    usropn                                                                         000015
    16 f                                     extfile('QTEMP/DSPFFD')                                                        000016
    17                                                                                                                      000017
    18  *=====================================================================                                              000018
    19  *   Data definition                                                                                                 000019
    20  *=====================================================================                                              000020
    21  *   file data structures                                                                                            000021
        *--------------------------------------------------------------------------------------------*
        *                               RPG name         External name                               *
        * File name. . . . . . . . . :  QADSPFFD         QSYS/QADSPFFD                               *
        * Record format(s) . . . . . :  QWHDRFFD         QWHDRFFD                                    *
        *--------------------------------------------------------------------------------------------*


    22 d pfdsi           ds                  likerec(PFHS_ENTR: *input)                                                     000022
    23 d pfdso           ds                  likerec(PFHS_ENTR: *output) inz                                                000023
    24 d dfdssf          ds                  likerec(HSTSF: *all)                                                           000024
    25 d dfdswi          ds                  likerec(HSTW : *input)                                                         000025
    26 d dfdswo          ds                  likerec(HSTW : *output)                                                        000026
    27 d dfdswi2         ds                  likerec(HSTW2: *input)                                                         000027
    28 d dfdswo2         ds                  likerec(HSTW2: *output)                                                        000028
    29 d dfdswi3         ds                  likerec(HSTW3: *input)                                                         000029
    30 d dfdswo3         ds                  likerec(HSTW3: *output)                                                        000030
    31                                                                                                                      000031
    32  *   constants                                                                                                       000032
    33 d EDIT            c                   const('E')                                                                     000033
    34 d DELETE          c                   const('D')                                                                     000034
    35 d COPY            c                   const('C')                                                                     000035
    36 d INCLUDE         c                   const('IN')                                                                    000036
    37 d EXCLUDE         c                   const('EX')                                                                    000037
    38                                                                                                                      000038
    39  *   variables                                                                                                       000039



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      3

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    40 d idxSfl          s             10u 0                                                                                000040
    41 d shouldFillSfl   s               n   inz(*off)                                                                      000041
    42 d recordWritten   s               n   inz(*off)                                                                      000042
    43 d seqNbr2         s                   like(SEQNBR)                                                                   000043
    44 d inex2           s                   like(INEX)                                                                     000044
    45                                                                                                                      000045
    46 d cmdText         s            200a                                                                                  000046
    47 d cmdLen          s             15p 5 inz(200)                                                                       000047
    48                                                                                                                      000048
    49 d idx             s             10u 0                                                                                000049
    50 d ctr             s             10i 0                                                                                000050
    51 d ctr2            s             10i 0                                                                                000051
    52 d ctr3            s             10i 0                                                                                000052
    53 d pos             s             10u 0                                                                                000053
    54 d limit           s             10u 0                                                                                000054
    55 d fld             ds          2000                                                                                   000055
    56 d  fa                            1    dim(2000)                                                                      000056
    57 d mask            ds          2000                                                                                   000057
    58 d  ma                            1    dim(2000)                                                                      000058
    59                                                                                                                      000059
    60  *  Parameters for QUSRJOBI API                                                                                      000060
    61 d len_bin         s             10i 0 inz(%size(QUSI0400))                                                           000061
    62 d format          s              8a   inz('JOBI0400')                                                                000062
    63 d jobname         s             26a   inz('*')                                                                       000063
    64 d int_job_id      s             16a   inz(' ')                                                                       000064
    65                                                                                                                      000065
    66  *  Record structure for QUSRJOBI JOBI0400 format                                                                    000066
    67 dQUSI0400         DS                                                                                                 000067
    68  *                                             Qwc JOBI0400                                                          000068
    69 d QUSBR03                 1      4B 0                                                                                000069
    70  *                                             Bytes Return                                                          000070
    71 d QUSBA03                 5      8B 0                                                                                000071
    72  *                                             Bytes Avail                                                           000072
    73 d QUSCCSID07            301    304B 0                                                                                000073
    74  *                                             Coded Char Set ID                                                     000074
    75                                                                                                                      000075
    76  *=====================================================================                                              000076
    77  *   Mainline code                                                                                                   000077
    78  *=====================================================================                                              000078
    79  /free                                                                                                               000079
    80      // retrieve current job CCSID                                                                                   000080


    81=IQWHDRFFD                                                                                                           1000001
        *--------------------------------------------------------------------------------------------*                     1
        * RPG record format  . . . . :  QWHDRFFD                                                     *                     1
        * External format  . . . . . :  QWHDRFFD : QSYS/QADSPFFD                                     *                     1
        * Format text  . . . . . . . :  DSPFFD data base format                                      *                     1
        *--------------------------------------------------------------------------------------------*                     1
    82=I                             A    1   10  WHFILE                          File                                     1000002
    83=I                             A   11   20  WHLIB                           Library                                  1000003
    84=I                             A   21   27  WHCRTD                          File creation date: century/date         1000004
    85=I                             A   28   28  WHFTYP                          Type of file: P=Physical, L=Logical, D=Device
    86=I                             S   29   33 0WHCNT                           Number of record formats                 1000006
    87=I                             A   34   46  WHDTTM                          Retrieval date: century/date/time        1000007
    88=I                             A   47   56  WHNAME                          Record format                            1000008



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      4

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    89=I                             A   57   69  WHSEQ                           Format level identifier                  1000009
    90=I                             A   70  119  WHTEXT                          Format text description                  1000010
    91=I                             S  120  124 0WHFLDN                          Number of fields and indicators          1000011
    92=I                             S  125  129 0WHRLEN                          Record format length                     1000012
    93=I                             A  130  139  WHFLDI                          Internal field name                      1000013
    94=I                             A  140  149  WHFLDE                          External field name                      1000014
    95=I                             S  150  154 0WHFOBO                          Output buffer position                   1000015
    96=I                             S  155  159 0WHIBO                           Input buffer position                    1000016
    97=I                             S  160  164 0WHFLDB                          Field length in bytes                    1000017
    98=I                             S  165  166 0WHFLDD                          Number of digits                         1000018
    99=I                             S  167  168 0WHFLDP                          Decimal positions to right of decimal    1000019
   100=I                             A  169  218  WHFTXT                          Field text description                   1000020
   101=I                             S  219  221 0WHRCDE                          32=Data Type,64=Name, 128=None           1000021
   102=I                             A  222  231  WHRFIL                          Reference file                           1000022
   103=I                             A  232  241  WHRLIB                          Reference library                        1000023
   104=I                             A  242  251  WHRFMT                          Reference record format                  1000024
   105=I                             A  252  261  WHRFLD                          Reference field                          1000025
   106=I                             A  262  281  WHCHD1                          Column heading 1                         1000026
   107=I                             A  282  301  WHCHD2                          Column heading 2                         1000027
   108=I                             A  302  321  WHCHD3                          Column heading 3                         1000028
   109=I                             A  322  322  WHFLDT                          Type: B,A,S,P,F,O,J,E,H,L,T,Z,G,1,2,3,4,5,6,7
   110=I                             A  323  323  WHFIOB                          I/O attribute: I=Input,O=Output,B=Both,N=Neither
   111=I                             A  324  325  WHECDE                          Edit code                                1000031
   112=I                             A  326  357  WHEWRD                          Edit word: Truncated after 30 characters
   113=I                             S  358  361 0WHVCNE                          Number of validity checks                1000033
   114=I                             S  362  366 0WHNFLD                          Number of fields                         1000034
   115=I                             S  367  368 0WHNIND                          Number of indicators                     1000035
   116=I                             A  369  369  WHSHFT                          Keyboard shift                           1000036
   117=I                             A  370  370  WHALTY                          Character field may be DBSC activated: N=No, Y=Yes
   118=I                             A  371  400  WHALIS                          Alternative field name                   1000038
   119=I                             S  401  402 0WHJREF                          Join reference to JFILE -1 = see WHJRF2
   120=I                             S  403  404 0WHDFTL                          DFT value length: -1=Greater than 30 characters
   121=I                             A  405  434  WHDFT                           DFT value: Truncated after 30 characters
   122=I                             A  435  435  WHCHRI                          Character Id changes allowed: N=No, Y=Yes
   123=I                             A  436  436  WHCTNT                          Translation table used:  N=No, Y=Yes     1000043
   124=I                             A  437  446  WHFONT                          Font identifier                          1000044
   125=I                             S  447  449 1WHCSWD                          Character size width                     1000045
   126=I                             S  450  452 1WHCSHI                          Character size height                    1000046
   127=I                             A  453  462  WHBCNM                          Barcode name                             1000047
   128=I                             S  463  465 1WHBCHI                          Barcode height:0=No height defined,-2=use WHBCUH
   129=I                             A  466  466  WHMAP                           Substring specified: N=No, Y=Yes         1000049
   130=I                             S  467  471 0WHMAPS                          Substring starting position              1000050
   131=I                             S  472  476 0WHMAPL                          Substring number of bytes (characters, if graphic)
   132=I                             A  477  484  WHSYSN                          System Name (Source System, if file is DDM)
   133=I                             A  485  486  WHRES1                          Reserved                                 1000053
   134=I                             A  487  487  WHSQLT                          SQL file type:0=None,T=TABLE,I=INDEX,V=VIEW,M=MQT
   135=I                             A  488  488  WHHEX                           Hexadecimal:  Y=Yes                      1000055
   136=I                             P  489  491 1WHPNTS                          Point size: 0 = none                     1000056
   137=I                             P  492  494 0WHCSID                          Coded Character set Identifier           1000057
   138=I                             A  495  498  WHFMT                           Date and time format parameters          1000058
   139=I                             A  499  499  WHSEP                           '/', '-', '.', ',', ':', ' ', or 'J'=*JOB
   140=I                             A  500  500  WHVARL                          Variable length field: N=No, Y=Yes       1000060
   141=I                             P  501  503 0WHALLC                          Allocated length                         1000061
   142=I                             A  504  504  WHNULL                          Allow Null Value: N=No,Y=Yes             1000062
   143=I                             A  505  514  WHFCSN                          Font character set, blank = none         1000063
   144=I                             A  515  524  WHFCSL                          Char set lib, blank = none               1000064



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      5

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   145=I                             A  525  534  WHFCPN                          Font code page, blank = none             1000065
   146=I                             A  535  544  WHFCPL                          Code page lib, blank = none              1000066
   147=I                             A  545  554  WHCDFN                          Coded Font, blank = none                 1000067
   148=I                             A  555  564  WHCDFL                          Coded font lib, blank = none             1000068
   149=I                             A  565  574  WHDCDF                          DBCS Coded Font, blank = none            1000069
   150=I                             A  575  584  WHDCDL                          DBCS font lib, blank = none              1000070
   151=I                             P  585  586 0WHTXRT                          Degree of text rotation, -1 = not specified
   152=I                             S  587  591 0WHFLDG                          Field length in characters, 0 = not graphic
   153=I                             S  592  596 0WHFDSL                          Alternate field length                   1000073
   154=I                             P  597  599 1WHFSPS                          Font character set point size. 0=*NONE
   155=I                             P  600  602 1WHCFPS                          Coded font point size. 0=*NONE           1000075
   156=I                             P  603  605 1WHIFPS                          DBCS Coded font point size. 0=*NONE      1000076
   157=I                             P  606  611 0WHDBLL                          LOB field length                         1000077
   158=I                             A  612  739  WHDBUN                          User-defined type name                   1000078
   159=I                             A  740  749  WHDBUL                          User-defined type library                1000079
   160=I                             A  750  750  WHDBFC                          0=No control, 1=File control             1000080
   161=I                             A  751  751  WHDBFI                          0=Selective, 1=All, blank=not valid      1000081
   162=I                             A  752  752  WHDBRP                          0=Database, 1=File system, blank=not valid
   163=I                             A  753  753  WHDBWP                          0=Blocked, 1=File system, blank=not valid
   164=I                             A  754  754  WHDBRC                          0=No, 1=Yes, blank=not valid             1000084
   165=I                             A  755  755  WHDBOU                          0=Delete, 1=Restore, blank=not valid     1000085
   166=I                             A  756  756  WHPSUD                          0=*NOCONVERT, 1=*CONVERT                 1000086
   167=I                             S  757  761 2WHBCUH                          Barcode height using UOM                 1000087
   168=I                             P  762  764 1WHFPSW                          Font point size width. 0=Not used        1000088
   169=I                             P  765  767 1WHFSPW                          Font character set point size width. 0=Not used
   170=I                             P  768  770 1WHCFPW                          Coded font point size width. 0=Not used
   171=I                             P  771  773 1WHIFPW                          DBCS Coded font point size width. 0=Not used
   172=I                             A  774  774  WHRWID                          ROWID specified. Y=Yes, N=No             1000092
   173=I                             A  775  775  WHIDC                           Identity column. Y=Yes, N=No             1000093
   174=I                             S  776  778 0WHDROW                          Display row                              1000094
   175=I                             S  779  781 0WHDCOL                          Display column                           1000095
   176=I                             A  782 1039  WHALI2                          Alternative field name                   1000096
   177=I                             A 1040 1040  WHALCH                          Alternate length 0=Characters,1=Display positions
   178=I                             A 1041 1041  WHNRML                          Field is normalized, 0=No, 1=Yes         1000098
   179=I                             S 1042 1044 0WHJRF2                          Join reference to JFILE 3 digits         1000099
   180=I                             A 1045 1045  WHHDNCOL                        Implicitly Hidden. 0=No, 1=Yes           1000100
   181=I                             A 1046 1046  WHRCTS                          0=No, 1=Yes, blank= not valid            1000101
   182=I                             A 1047 1056  WHFPPN                          Field Procedure program name             1000102
   183=I                             A 1057 1066  WHFPLN                          Field Procedure library name             1000103


   184      exsr rtvJobCCSID; // for CCSIDJOB in database                                                                   000081
   185                                                                                                                      000082
   186      // open database file                                                                                           000083
   187      open(e) PFHS_ENT;                                                                              _MOD             000084
   188                                                                                                                      000085
   189      // process filter records for journal entry type                                                                000086
   190      // ---------------------------------------------                                                                000087
   191      // fill subfile and databale with table data (type,desctiption)                                                 000088
   192      exsr fillSfl;                                                                                                   000089
   193      // display list of filter records                                                                               000090
   194      write FUNCKEYS;  // show function keys format                                                                   000091
   195      exfmt HSTCT ;    // show subfile format                                                                         000092
   196                                                                                                                      000093
   197      dow 0 = 0;       // endless cycle                                                          B01                  000094
   198         if *in03 or *in12;  // F3 or F12 - end program                                          B02                  000095



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      6

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   199            exsr endpgm;                                                                          02                  000096
   200         elseif *in06;       // F6  - create new record and fill subfile                         X02                  000097
   201            recordWritten = *off;   // note that no new record was written so far                 02                  000098
   202            exsr newRec;                                                                          02                  000099
   203            exsr fillSfl;                                                                         02                  000100
   204         elseif *in14;       // F14 - clear file and fill subfile                                X02                  000101
   205            exsr clearFile;                                                                       02                  000102
   206            exsr fillSfl;                                                                         02                  000103
   207         elseif *in01;       // F1  - help display                                               X02                  000104
   208            exsr dspHelp;                                                                         02                  000105
   209         else;                                                                                   X02                  000106
   210                             // Enter                                                                                 000107
   211            exsr procSfl;    // process subfile                                                   02                  000108
   212            if shouldFillSfl;   // fill subfile except Edit or Invalid Option                    B03                  000109
   213               exsr fillSfl;                                                                      03                  000110
   214            endif;                                                                               E03                  000111
   215         endif;                                                                                  E02                  000112
   216                                                                                                                      000113
   217         write FUNCKEYS;  // show function keys format                                            01                  000114
   218         exfmt HSTCT ;    // show subfile format                                                  01                  000115
   219      enddo;  // endless cycle                                                                   E01                  000116
   220                                                                                                                      000117
   221   //====================================================================                                             000118
   222   //  Subroutines                                                                                                    000119
   223   //====================================================================                                             000120
   224                                                                                                                      000121
   225   // -------------------------------------------------------------------                                             000122
   226   // clear physical file member                                                                                      000123
   227   // -------------------------------------------------------------------                                             000124
   228   begsr clearFile;                                                                                                   000125
   229                                                                                                                      000126
   230      close PFHS_ENT;   // close db file                                                             _MOD             000127
   231                                                                                                                      000128
   232      // perform CL command CLRPFM PFHS_ENT                                                          _MOD             000129
   233      cmdText= 'CLRPFM PFHS_ENT';                                                                    _MOD             000130
   234  /end-free                                                                                                           000131
   235 c                   call      'QCMDEXC'                                                                              000132
   236 c                   parm                    cmdText                                                                  000133
   237 c                   parm                    cmdLen                                                                   000134
   238  /free                                                                                                               000135
   239                                                                                                                      000136
   240      open PFHS_ENT;     // open db file again                                                       _MOD             000137
   241                                                                                                                      000138
   242   endsr; // clearFile                                                                                                000139
   243                                                                                                                      000140
   244   // -------------------------------------------------------------------                                             000141
   245   // end program                                                                                                     000142
   246   // -------------------------------------------------------------------                                             000143
   247   begsr endpgm;                                                                                                      000144
   248      *inlr = *on;                                                                                                    000145
   249      return;                                                                                                         000146
   250   endsr; // endpgm                                                                                                   000147
   251                                                                                                                      000148
   252   // -------------------------------------------------------------------                                             000149
   253   // fill subfile                                                                                                    000150
   254   // -------------------------------------------------------------------                                             000151



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      7

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   255   begsr fillSfl;                                                                                                     000152
   256      // clear whole subfile                                                                                          000153
   257      *in56 = *on;                                                                                                    000154
   258      write  HSTCT;                                                                                                   000155
   259      *in56 = *off;                                                                                                   000156
   260                                                                                                                      000157
   261      // fill subfile with database records                                                                           000158
   262      CSR = 1;                                                                                                        000159
   263      idxSfl = 0;              // clear subfile record sequential number                                              000160
   264      dfdssf.OPTION = *blank;  // clear subfile record OPTION value                                                   000161
   265      setll *loval PFHS_ENT;   // set start of database file                                                          000162
   266      read(n) PFHS_ENT pfdsi;   // read first db record (no lock)                                                     000163
   267      dow not %eof;            // process whole database file                                    B01                  000164
   268         idxSfl += 1;             // set number of next subfile record                            01                  000165
   269         dfdssf.SEQNBRH = pfdsi.SEQNBR; // save copy of seq. number for Chain                     01                  000166
   270         eval-corr dfdssf = pfdsi;      // input data to subfile record                           01                  000167
   271         write HSTSF dfdssf;     // write subfile record                                          01                  000168
   272         read(n) PFHS_ENT pfdsi;  // read next db record (no lock)                                01                  000169
   273      enddo;                                                                                     E01                  000170
   274      *in51 = idxSfl > 0;      // enable/disable displaying subfile                                                   000171
   275   endsr; // fillSfl                                                                                                  000172
   276                                                                                                                      000173
   277   // -------------------------------------------------------------------                                             000174
   278   // process subfile                                                                                                 000175
   279   // -------------------------------------------------------------------                                             000176
   280   begsr procSfl;                                                                                                     000177
   281      *in89 = *off;    // set off global error in Option field                                                        000178
   282      shouldFillSfl = *on ; // subfile will be filled again                                                           000179
   283      if *in51;                                                                                  B01                  000180
   284         readc HSTSF dfdssf;  // read first changed subfile record                                01                  000181
   285         dow not %eof;        // process all changed subfile records                             B02                  000182
   286            CSR = idxSfl;        // set cursor for displaying subfile                             02                  000183
   287            exsr chkSfFields;    // check if subfile fields are correct                           02                  000184
   288            // if no error on subfile fields - process the fields                                                     000185
   289            if not *in80 and not *in81 and not *in82;                                            B03                  000186
   290               dfdssf.in80 = *off;    // set off OPTION invalid flag in subfile                   03                  000187
   291               dfdssf.in81 = *off;    // set off SEQNBR invalid flag in subfile                   03                  000188
   292               dfdssf.in82 = *off;    // set off INEX invalid flag in subfile                     03                  000189
   293               if dfdssf.OPTION = EDIT;                                                          B04                  000190
   294                  exsr editRec;          // edit and update db record data                        04                  000191
   295                  dfdssf.OPTION = *blank;    // clear Option field when correct                   04                  000192
   296                  if dfdssf.SEQNBR = dfdssf.SEQNBRH;   // if seq. number not changed in subfile  B05                  000193
   297                     shouldFillSfl = *off;      // subfile will not be filled again               05                  000194
   298                  endif;                                                                         E05                  000195
   299                  if not dfdswi.in12;                                                            B05                  000196
   300                     eval-corr dfdssf = pfdso; // output db data to sub  file data structure      05                  000197
   301                  endif;                                                                         E05                  000198
   302                  update HSTSF dfdssf;       // update subfile record                             04                  000199
   303               elseif dfdssf.OPTION = DELETE;                                                    X04                  000200
   304                  exsr deleteRec;                                                                 04                  000201
   305               elseif dfdssf.OPTION = COPY;                                                      X04                  000202
   306                  exsr copyRec;                                                                   04                  000203
   307               elseif dfdssf.OPTION = *blank;                                                    X04                  000204
   308                  exsr chgSfFields;       // change subfile fields                                04                  000205
   309                  if dfdssf.SEQNBR = dfdssf.SEQNBRH   // if no subfile fields changed            B05                  000206
   310                  and dfdssf.INEX = dfdssf.INEX;                                                 B05                  000207



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      8

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   311                     shouldFillSfl = *off;  // subfile will not be filled again                   05                  000208
   312                  endif;                                                                         E05                  000209
   313                  update HSTSF dfdssf;       // update subfile record                             04                  000210
   314               endif;                                                                            E04                  000211
   315            else;                // Some subfile fields are incorrect                            X03                  000212
   316               shouldFillSfl = *off;  // subfile will not be filled again                         03                  000213
   317               dfdssf.in80 = *in80;   // OPTION indicator                                         03                  000214
   318               dfdssf.in81 = *in81;   // SEQNBR indicator                                         03                  000215
   319               dfdssf.in82 = *in82;   // INEX indicator                                           03                  000216
   320               update HSTSF dfdssf;                                                               03                  000217
   321            endif;                                                                               E03                  000218
   322            readc HSTSF dfdssf;   // read next changed subfile record                             02                  000219
   323         enddo;                                                                                  E02                  000220
   324      endif;                                                                                     E01                  000221
   325   endsr; // procSfl                                                                                                  000222
   326                                                                                                                      000223
   327   // -------------------------------------------------------------------                                             000224
   328   // create new record (header and detail part)                                                                      000225
   329   // -------------------------------------------------------------------                                             000226
   330   begsr newRec;                                                                                                      000227
   331      clear pfdso;       // clear data in db output                                                                   000228
   332      clear dfdswo;      // clear data in display window                                                              000229
   333      clear dfdswo2;     // clear data in display window2                                                             000230
   334      clear dfdswo3;     // clear data in display window3                                                             000231
   335      dfdswo.TYPE  = TYPE;     // set TYPE for window                                                                 000232
   336      dfdswo.INEX  = INCLUDE;  // set INEX for window                                                                 000233
   337      ctr = 0;                                                                                                        000234
   338      dow 0=0;                                                                                   B01                  000235
   339         write HSTW dfdswo; // write and read                                                     01                  000236
   340         read HSTW dfdswi;  // display the window                                                 01                  000237
   341         if dfdswi.in03;      // F3 - end program                                                B02                  000238
   342            exsr endpgm;                                                                          02                  000239
   343         elseif dfdswi.in12;  // F12 - return to subfile processing                              X02                  000240
   344            leavesr;                                                                              02                  000241
   345         elseif dfdswi.in01;  // F1  - help display                                              X02                  000242
   346            exsr dspHelpw;                                                                        02                  000243
   347            iter;                                                                                 02                  000244
   348         elseif dfdswi.in07;  // F7  - process the second window                                 X02                  000245
   349            if not recordWritten;  // write one record only                                      B03                  000246
   350               exsr wrtRec;        // write new record with header fields                         03                  000247
   351               recordWritten = *on;                                                               03                  000248
   352            else;                                                                                X03                  000249
   353               exsr updNewRec;                                                                    03                  000250
   354            endif;                                                                               E03                  000251
   355            exsr newRec2;       // display second window                                          02                  000252
   356            if dfdswi2.in12 or dfdswi3.in12;                                                     B03                  000253
   357               leavesr;                                                                           03                  000254
   358            endif;                                                                               E03                  000255
   359            ctr = -1;        // suppress leaving subroutine for the first time                    02                  000256
   360         endif;              //    on returning from window2                                     E02                  000257
   361                                                                                                                      000258
   362                     // Enter                                                                                         000259
   363         // add new record once only                                                                                  000260
   364         ctr += 1;                                                                                01                  000261
   365         if ctr > 1 and not dfdswi.in99;  // Enter second time or after no change                B02                  000262
   366            leavesr;                                                                              02                  000263



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page      9

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   367         else;                                                                                   X02                  000264
   368            if not recordWritten;  // write one record only                                      B03                  000265
   369               exsr wrtRec;        // write new record with header fields                         03                  000266
   370               recordWritten = *on;                                                               03                  000267
   371            else;                                                                                X03                  000268
   372               exsr updNewRec;                                                                    03                  000269
   373            endif;                                                                               E03                  000270
   374            iter;               // return to display                                              02                  000271
   375         endif;                                                                                  E02                  000272
   376      enddo;                                                                                     E01                  000273
   377   endsr; // newRec                                                                                                   000274
   378                                                                                                                      000275
   379   // -------------------------------------------------------------------                                             000276
   380   // wrtRec - write new record with header fields                                                                    000277
   381   // -------------------------------------------------------------------                                             000278
   382   begsr wrtRec;                                                                                                      000279
   383         // get next sequential number for the new record                                                             000280
   384         pfdsi.SEQNBR = 0;          // clear seq. number                                                              000281
   385         setLL *hival PFHS_ENT;     // set end of db file                                                             000282
   386         readp(n) PFHS_ENT pfdsi;    // read last db record                                                           000283
   387         pfdso.SEQNBR = pfdsi.SEQNBR + 10; // add 10 to sequence number                                               000284
   388                                                                                                                      000285
   389         // add data to new record                                                                                    000286
   390         eval-corr pfdso = dfdswi;  // data from window to db output                                                  000287
   391         pfdso.TYPE  = TYPE;        // set TYPE for db record                                                         000288
   392         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                                     000289
   393         pfdso.INEX = INCLUDE;      // initial value of Include/Exclude field                                         000290
   394         exsr positions;                                                                                              000291
   395                                                                                                                      000292
   396         // create selection masks for all filter fields                                                              000293
   397         exsr createMasks;                                                                                            000294
   398                                                                                                                      000295
   399         write(e) PFHS_ENTR  pfdso;   // write new db record with data from window                                    000296
   400         eval-corr dfdswo = dfdswi; // data from window input to output                                               000297
   401   endsr; // wrtRec                                                                                                   000298
   402                                                                                                                      000299
   403   // -------------------------------------------------------------------                                             000300
   404   // updNewRec - update first (header) part of newly written record                                                  000301
   405   // -------------------------------------------------------------------                                             000302
   406   begsr updNewRec;                                                                                                   000303
   407      chain  pfdso.SEQNBR PFHS_ENT;    // read database record for seq. number                                        000304
   408      if %found;                                                                                 B01                  000305
   409         eval-corr pfdso = dfdswi;     // data from window input to db record                     01                  000306
   410         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000307
   411         exsr createMasks;             // create masks for data fields                            01                  000308
   412         update PFHS_ENTR pfdso;         // update db record                                      01                  000309
   413         eval-corr dfdswo = dfdswi;    // window input to window output                           01                  000310
   414      endif;                                                                                     E01                  000311
   415   endsr; // updNewRec                                                                                                000312
   416                                                                                                                      000313
   417   // -------------------------------------------------------------------                                             000314
   418   // newRec2 - create rest of the record (detail part)                                                               000315
   419   // -------------------------------------------------------------------                                             000316
   420   begsr newRec2;                                                                                                     000317
   421      dfdswo2.TYPE  = TYPE;     // set TYPE for window                                                                000318
   422      dfdswo2.INEX  = INCLUDE;  // set INEX for window                                                                000319



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     10

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   423      ctr2 = 0;                                                                                                       000320
   424      dow 0=0;                                                                                   B01                  000321
   425         write HSTW2 dfdswo2; // write and read                                                   01                  000322
   426         read HSTW2 dfdswi2;  // display the second window                                        01                  000323
   427         if dfdswi2.in03;    // F3 - end program                                                 B02                  000324
   428            exsr endpgm;                                                                          02                  000325
   429         elseif dfdswi2.in12;   // 12 - return to the second display fo rmat                     X02                  000326
   430            leavesr;           // return to newRec                                                02                  000327
   431         elseif dfdswi2.in01;  // F1  - help display                                             X02                  000328
   432            exsr dspHelpw2;                                                                       02                  000329
   433            iter;                                                                                 02                  000330
   434         elseif dfdswi2.in07;      // F7  - process the third window                             X02                  000331
   435            exsr updNewRec2;         // update second part of newly written record                02                  000332
   436            exsr newRec3;            // and save as if Enter                                      02                  000333
   437            if dfdswi3.in12;                                                                     B03                  000334
   438               leavesr;                                                                           03                  000335
   439            endif;                                                                               E03                  000336
   440            ctr2 = -1;         // suppress leaving subroutine for the first time                  02                  000337
   441         endif;                //    on returning from window3                                   E02                  000338
   442                                                                                                                      000339
   443                            // Enter                                                                                  000340
   444         // add data to new record buffer                                                                             000341
   445         eval-corr pfdso = dfdswi2;  // data from window to db output                             01                  000342
   446         pfdso.TYPE  = TYPE;        // set TYPE for db record                                     01                  000343
   447         pfdso.INEX = INCLUDE;      // initial value of Include/Exclude field                     01                  000344
   448                                                                                                                      000345
   449         eval-corr dfdswo2 = dfdswi2;  // data from window input to window output                 01                  000346
   450                                                                                                                      000347
   451         // add new record once only                                                                                  000348
   452         ctr2 += 1;                                                                               01                  000349
   453         if ctr2 > 1 and not dfdswi2.in99;  // Enter second time or after no change              B02                  000350
   454            leavesr;                                                                              02                  000351
   455         else;                                                                                   X02                  000352
   456            exsr updNewRec2;   // update second part of newly written record                      02                  000353
   457            iter;                                                                                 02                  000354
   458         endif;                                                                                  E02                  000355
   459      enddo;                                                                                     E01                  000356
   460   endsr; // newRec2                                                                                                  000357
   461                                                                                                                      000358
   462   // -------------------------------------------------------------------                                             000359
   463   // updNewRec2 - update second part of newly written record                                                         000360
   464   // -------------------------------------------------------------------                                             000361
   465   begsr updNewRec2;                                                                                                  000362
   466      chain  pfdso.SEQNBR PFHS_ENT;    // read database record for seq. number                                        000363
   467      if %found;                                                                                 B01                  000364
   468         eval-corr pfdso = dfdswi2;    // data from window input to db record                     01                  000365
   469         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000366
   470         exsr createMasks;             // create masks for data fields                            01                  000367
   471         update PFHS_ENTR pfdso;         // update db record                                      01                  000368
   472         eval-corr dfdswo = dfdswi2;   // window input to window output                           01                  000369
   473      endif;                                                                                     E01                  000370
   474   endsr; // updNewRec2                                                                                               000371
   475                                                                                                                      000372
   476   // -------------------------------------------------------------------                                             000373
   477   // newRec3 - create rest of the record (next detail part)                                                          000374
   478   // -------------------------------------------------------------------                                             000375



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     11

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   479   begsr newRec3;                                                                                                     000376
   480      dfdswo3.TYPE  = TYPE;     // set TYPE for window                                                                000377
   481      dfdswo3.INEX  = INCLUDE;  // set TYPE for window                                                                000378
   482      ctr3 = 0;                                                                                                       000379
   483      dow 0=0;                                                                                   B01                  000380
   484         write HSTW3 dfdswo3; // write and read                                                   01                  000381
   485         read HSTW3 dfdswi3;  // display the second window                                        01                  000382
   486         if dfdswi3.in03;    // F3 - end program                                                 B02                  000383
   487            exsr endpgm;                                                                          02                  000384
   488         elseif dfdswi3.in12;    // F12 - return to the second display format                    X02                  000385
   489            leavesr;           // return to newRec                                                02                  000386
   490         elseif dfdswi3.in01;  // F1  - help display                                             X02                  000387
   491            exsr dspHelpw3;                                                                       02                  000388
   492            iter;                                                                                 02                  000389
   493         endif;                                                                                  E02                  000390
   494                            // Enter                                                                                  000391
   495         // add data to new record buffer                                                                             000392
   496         eval-corr pfdso = dfdswi3;  // data from window to db output                             01                  000393
   497         pfdso.TYPE  = TYPE;        // set TYPE for db record                                     01                  000394
   498         pfdso.INEX = INCLUDE;      // initial value of Include/Exclude field                     01                  000395
   499                                                                                                                      000396
   500         eval-corr dfdswo3 = dfdswi3;  // data from window input to window output                 01                  000397
   501                                                                                                                      000398
   502         // add new record once only                                                                                  000399
   503         ctr3 += 1;                                                                               01                  000400
   504         if ctr3 > 1 and not dfdswi3.in99;  // Enter second time or after no change              B02                  000401
   505            leavesr;                                                                              02                  000402
   506         else;                                                                                   X02                  000403
   507            exsr updNewRec3;   // update third part of newly written record                       02                  000404
   508            iter;                                                                                 02                  000405
   509         endif;                                                                                  E02                  000406
   510      enddo;                                                                                     E01                  000407
   511   endsr; // newRec3                                                                                                  000408
   512                                                                                                                      000409
   513   // -------------------------------------------------------------------                                             000410
   514   // updNewRec3 - update third part of newly written record                                                          000411
   515   // -------------------------------------------------------------------                                             000412
   516   begsr updNewRec3;                                                                                                  000413
   517      chain  pfdso.SEQNBR PFHS_ENT;    // read database record for seq. number                                        000414
   518      if %found;                                                                                 B01                  000415
   519         eval-corr pfdso = dfdswi3;    // data from window input to db record                     01                  000416
   520         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000417
   521         exsr createMasks;             // create masks for data fields                            01                  000418
   522         update PFHS_ENTR pfdso;         // update db record                                      01                  000419
   523         eval-corr dfdswo = dfdswi3;   // window input to window output                           01                  000420
   524      endif;                                                                                     E01                  000421
   525   endsr; // updNewRec3                                                                                               000422
   526                                                                                                                      000423
   527   // -------------------------------------------------------------------                                             000424
   528   // check Subfile fields                                                                                            000425
   529   // -------------------------------------------------------------------                                             000426
   530   begsr chkSfFields;                                                                                                 000427
   531      // check OPTION field                                                                                           000428
   532      *in80 = *off;     // valid OPTION                                                                               000429
   533      if  not (dfdssf.OPTION = EDIT                                                              B01                  000430
   534            or dfdssf.OPTION = DELETE                                                            B01                  000431



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     12

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   535            or dfdssf.OPTION = COPY                                                              B01                  000432
   536            or dfdssf.OPTION = *blank);                                                          B01                  000433
   537         *in80 = *on;   // invalid Option                                                         01                  000434
   538         *in89 = *on;   // global warning over whole subfile                                      01                  000435
   539      endif;                                                                                     E01                  000436
   540                                                                                                                      000437
   541      // check SEQNBR for duplication                                                                                 000438
   542      *in81 = *off;     // valid SEQNBR                                                                               000439
   543      seqNbr2 = dfdssf.SEQNBR; // save (possibly changed) subfile fields                                              000440
   544      chain dfdssf.SEQNBRH PFHS_ENT pfdsi;   // read database record f  or original                                   000441
   545                                       // seq. number that was saved when                                             000442
   546                                       // subfile was filled                                                          000443
   547      if %found;                                                                                 B01                  000444
   548         if seqNbr2 <> dfdssf.SEQNBRH; // seq. numbers differ                                    B02                  000445
   549            setll seqNbr2 PFHS_ENT;    // search for new seq. number in db file                   02                  000446
   550            if %equal;                 // new seq. number exists in db file                      B03                  000447
   551            *in81=*on;      // seq. number duplicated                                             03                  000448
   552            *in89 = *on;   // global warning over whole subfile                                   03                  000449
   553            endif;                                                                               E03                  000450
   554         endif;                                                                                  E02                  000451
   555      endif;                                                                                     E01                  000452
   556                                                                                                                      000453
   557      // check INEX field                                                                                             000454
   558      *in82 = *off;     // valid INEX                                                                                 000455
   559      if not (dfdssf.INEX = INCLUDE                                                              B01                  000456
   560           or dfdssf.INEX = EXCLUDE);                                                            B01                  000457
   561         *in82 = *on;   // invalid Include/Exclude flag                                           01                  000458
   562         *in89 = *on;   // global warning over whole subfile                                      01                  000459
   563      endif;                                                                                     E01                  000460
   564   endsr; // checkOptINEX                                                                                             000461
   565                                                                                                                      000462
   566   // -------------------------------------------------------------------                                             000463
   567   // editRec - edit/update record data (header and detail part)                                                      000464
   568   // -------------------------------------------------------------------                                             000465
   569   begsr editRec;                                                                                                     000466
   570      seqNbr2 = dfdssf.SEQNBR; // save (possibly changed) seq. number from subfile                                    000467
   571      eval-corr dfdswo = dfdssf;                                                                                      000468
   572      dfdswo.TYPE  = TYPE;     // set TYPE for window                                                                 000469
   573      ctr = 0;                                                                                                        000470
   574      dow 0=0;                                                                                   B01                  000471
   575         write HSTW dfdswo; // write and read                                                     01                  000472
   576         read HSTW dfdswi;  // display the window                                                 01                  000473
   577         if dfdswi.in03;    // F3 - end program                                                  B02                  000474
   578            exsr endpgm;                                                                          02                  000475
   579         elseif dfdswi.in12;    // F12 - Cancel                                                  X02                  000476
   580            eval-corr dfdssf = dfdswo;  // restore original subfile data                          02                  000477
   581            leavesr;                                                                              02                  000478
   582         elseif dfdswi.in01;    // F1 - help                                                     X02                  000479
   583            exsr dspHelpw;                                                                        02                  000480
   584            iter;                                                                                 02                  000481
   585         elseif dfdswi.in07;    // F7  - process second window and continue as Enter             X02                  000482
   586            exsr updRec;               // update header record                                    02                  000483
   587            exsr editRec2;             // display second format                                   02                  000484
   588            if dfdswi2.in12 or dfdswi3.in12;                                                     B03                  000485
   589               leavesr;                                                                           03                  000486
   590            endif;                                                                               E03                  000487



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     13

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   591            ctr = -1;        // suppress leaving subroutine for the first time                    02                  000488
   592         endif;              //    on returning from window2                                     E02                  000489
   593                                                                                                                      000490
   594                     // Enter, also after F7                                                                          000491
   595         // repeat display again once only                                                                            000492
   596         ctr += 1;                                                                                01                  000493
   597         if ctr > 1 and not dfdswi.in99;  // Enter second time or after no change                B02                  000494
   598            exsr updRec;  // update header record                                                 02                  000495
   599            leavesr;                                                                              02                  000496
   600         else;        // Enter first time                                                        X02                  000497
   601            exsr updRec;  // update header record                                                 02                  000498
   602            iter;   // repeat display                                                             02                  000499
   603         endif;                                                                                  E02                  000500
   604      enddo;                                                                                     E01                  000501
   605   endsr; // editRec                                                                                                  000502
   606                                                                                                                      000503
   607   // -------------------------------------------------------------------                                             000504
   608   // updRec - update first (header) part of data record                                                              000505
   609   // -------------------------------------------------------------------                                             000506
   610   begsr updRec;                                                                                                      000507
   611      chain  dfdssf.SEQNBRH PFHS_ENT pfdsi;  // read database record for original                                     000508
   612                                       // seq. number that was saved when                                             000509
   613                                       // subfile was filled                                                          000510
   614      if %found;                                                                                 B01                  000511
   615         pfdso.SEQNBR = seqNbr2;       // restore (possibly changed) seq. number                  01                  000512
   616         eval-corr pfdso = pfdsi ;     // data from db chain input                                01                  000513
   617         eval-corr pfdso = dfdswi;     // data from window input to db record                     01                  000514
   618         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000515
   619                                                                                                                      000516
   620         exsr positions;                                                                          01                  000517
   621                                                                                                                      000518
   622         exsr createMasks;             // create masks for data fields                            01                  000519
   623         update PFHS_ENTR pfdso;         // update db record                                      01                  000520
   624         eval-corr dfdswo = dfdswi;    // window input to window output                           01                  000521
   625         eval-corr dfdssf = pfdso ;    // db record to subfile                                    01                  000522
   626      endif;                                                                                     E01                  000523
   627   endsr; // updRec                                                                                                   000524
   628                                                                                                                      000525
   629   // -------------------------------------------------------------------                                             000526
   630   // editRec2 - edit/update second part of data record                                                               000527
   631   // -------------------------------------------------------------------                                             000528
   632   begsr editRec2;                                                                                                    000529
   633      eval-corr dfdswo2 = dfdssf;                                                                                     000530
   634      dfdswo2.TYPE  = TYPE;     // set TYPE for window                                                                000531
   635      ctr2 = 0;                                                                                                       000532
   636      dow 0=0;                                                                                   B01                  000533
   637         write HSTW2 dfdswo2; // write and read                                                   01                  000534
   638         read HSTW2 dfdswi2;  // display the window                                               01                  000535
   639         if dfdswi2.in03;    // F3 - end program                                                 B02                  000536
   640            exsr endpgm;                                                                          02                  000537
   641         endif;                                                                                  E02                  000538
   642         if dfdswi2.in12;     // F12 - Cancel                                                    B02                  000539
   643            eval-corr dfdssf = dfdswo2;    // restore original subfile data                       02                  000540
   644            leavesr;                                                                              02                  000541
   645         elseif dfdswi2.in01;    // F1 - help                                                    X02                  000542
   646            exsr dspHelpw2;                                                                       02                  000543



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     14

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   647            iter;                                                                                 02                  000544
   648         elseif dfdswi2.in07;    // F7  - process third window and continue as Enter             X02                  000545
   649            exsr updRec2;                                                                         02                  000546
   650            exsr editRec3;                                                                        02                  000547
   651            ctr2 = -1;         // suppress leaving subroutine for the first time                  02                  000548
   652            if dfdswi3.in12;                                                                     B03                  000549
   653               leavesr;                                                                           03                  000550
   654            endif;                                                                               E03                  000551
   655            ctr2 = -1;         // suppress leaving subroutine for the first time                  02                  000552
   656         endif;                //    on returning from window3                                   E02                  000553
   657                                                                                                                      000554
   658                           // Enter, also after F7                                                                    000555
   659         // repeat display again once only                                                                            000556
   660         ctr2 += 1;                                                                               01                  000557
   661         if ctr2 > 1 and not dfdswi2.in99;  // Enter second time or after no change              B02                  000558
   662            leavesr;                                                                              02                  000559
   663         else;                                                                                   X02                  000560
   664            exsr updRec2;  // update db record                                                    02                  000561
   665            iter;                                                                                 02                  000562
   666         endif;                                                                                  E02                  000563
   667      enddo;                                                                                     E01                  000564
   668   endsr; // editRec2                                                                                                 000565
   669                                                                                                                      000566
   670   // -------------------------------------------------------------------                                             000567
   671   // updRec2 - update second part of data record                                                                     000568
   672   // -------------------------------------------------------------------                                             000569
   673   begsr updRec2;                                                                                                     000570
   674      chain  dfdssf.SEQNBRH PFHS_ENT pfdsi; // read database record for original                                      000571
   675                                       // seq. number that was saved when                                             000572
   676                                       // subfile was filled                                                          000573
   677      if %found;                                                                                 B01                  000574
   678         pfdso.SEQNBR = seqNbr2;       // restore (possibly changed) seq. number                  01                  000575
   679         eval-corr pfdso = pfdsi ;     // data from db chain input                                01                  000576
   680         eval-corr pfdso = dfdswi2;    // data from window input to db record                     01                  000577
   681         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000578
   682                                                                                                                      000579
   683         exsr positions;                                                                          01                  000580
   684                                                                                                                      000581
   685         exsr createMasks;             // create masks for data fields                            01                  000582
   686         update PFHS_ENTR pfdso;         // update db record                                      01                  000583
   687         eval-corr dfdswo2 = dfdswi2;  // window input to window output                           01                  000584
   688         eval-corr dfdssf  = pfdso  ;  // db record to subfile                                    01                  000585
   689      endif;                                                                                     E01                  000586
   690   endsr; // updRec2                                                                                                  000587
   691                                                                                                                      000588
   692   // -------------------------------------------------------------------                                             000589
   693   // editRec3 - edit/update third part of data record                                                                000590
   694   // -------------------------------------------------------------------                                             000591
   695   begsr editRec3;                                                                                                    000592
   696      eval-corr dfdswo3 = dfdssf;                                                                                     000593
   697      dfdswo3.TYPE  = TYPE;     // set TYPE for window                                                                000594
   698      ctr3 = 0;                                                                                                       000595
   699      dow 0=0;                                                                                   B01                  000596
   700         write HSTW3 dfdswo3; // write and read                                                   01                  000597
   701         read HSTW3 dfdswi3;  // display the window                                               01                  000598
   702         if dfdswi3.in03;    // F3 - end program                                                 B02                  000599



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     15

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   703            exsr endpgm;                                                                          02                  000600
   704         elseif dfdswi3.in12;     // F12 - Cancel                                                X02                  000601
   705            eval-corr dfdssf = dfdswo3;    // restore original subfile data                       02                  000602
   706            leavesr;                                                                              02                  000603
   707         elseif dfdswi3.in01;    // F1 - help                                                    X02                  000604
   708            exsr dspHelpw3;                                                                       02                  000605
   709            iter;                                                                                 02                  000606
   710         endif;                                                                                  E02                  000607
   711                                                                                                                      000608
   712                           // Enter                                                                                   000609
   713         // repeat display again once only                                                                            000610
   714         ctr3 += 1;                                                                               01                  000611
   715         if ctr3 > 1 and not dfdswi3.in99;  // Enter second time or after no change              B02                  000612
   716            leavesr;                                                                              02                  000613
   717         else;                                                                                   X02                  000614
   718            exsr updRec3;                                                                         02                  000615
   719            iter;                                                                                 02                  000616
   720         endif;                                                                                  E02                  000617
   721      enddo;                                                                                     E01                  000618
   722   endsr; // editRec3                                                                                                 000619
   723                                                                                                                      000620
   724   // -------------------------------------------------------------------                                             000621
   725   // updRec3 - update third part of data record                                                                      000622
   726   // -------------------------------------------------------------------                                             000623
   727   begsr updRec3;                                                                                                     000624
   728      chain  dfdssf.SEQNBRH PFHS_ENT pfdsi; // read database record for original                                      000625
   729                                       // seq. number that was saved when                                             000626
   730                                       // subfile was filled                                                          000627
   731      if %found;                                                                                 B01                  000628
   732         pfdso.SEQNBR = seqNbr2;       // restore (possibly changed) seq. number                  01                  000629
   733         eval-corr pfdso = dfdswi3;    // data from window input to db record                     01                  000630
   734         pfdso.CCSIDJOB = CCSIDJOB; // set CCSIDJOB for db record                                 01                  000631
   735                                                                                                                      000632
   736         exsr positions;                                                                          01                  000633
   737                                                                                                                      000634
   738         exsr createMasks;             // create masks for data fields                            01                  000635
   739         update PFHS_ENTR pfdso;         // update db record                                      01                  000636
   740         eval-corr dfdswo3 = dfdswi3;  // window input to window ooutput                          01                  000637
   741         eval-corr dfdssf  = pfdso  ;  // db record to subfile                                    01                  000638
   742      endif;                                                                                     E01                  000639
   743   endsr; // updRec3                                                                                                  000640
   744                                                                                                                      000641
   745   // -------------------------------------------------------------------                                             000642
   746   // Set position and length in text fields to select                                                                000643
   747   // -------------------------------------------------------------------                                             000644
   748   begsr positions;                                                                                                   000645
   749      pfdso.STRPOS1 = 0;                                                                                              000646
   750      pfdso.LENTXT1 = %len(%trimr(pfdso.FRSTTXT));                                                                    000647
   751      pfdso.STRPOS2 = 0;                                                                                              000648
   752      pfdso.LENTXT2 = %len(%trimr(pfdso.SECTXT));                                                                     000649
   753   endsr; // positions;                                                                                               000650
   754                                                                                                                      000651
   755   // -------------------------------------------------------------------                                             000652
   756   // change subfile fields                                                                                           000653
   757   // -------------------------------------------------------------------                                             000654
   758   begsr chgSfFields;                                                                                                 000655



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     16

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   759      seqNbr2 = dfdssf.SEQNBR; // save (possibly changed) subfile fields                                              000656
   760      inex2 = dfdssf.INEX;                                                                                            000657
   761      chain dfdssf.SEQNBRH PFHS_ENT pfdsi; // read database record for original                                       000658
   762                                       // seq. number that was saved when                                             000659
   763                                       // subfile was filled                                                          000660
   764      if %found;                                                                                 B01                  000661
   765         eval-corr pfdso = pfdsi ;     // data from db chain input                                01                  000662
   766         eval-corr pfdso = dfdswi3;    // data from window input to db record                     01                  000663
   767         pfdso.SEQNBR = seqNbr2;  // restore (possibly changed) subfile fields                    01                  000664
   768         pfdso.INEX = inex2;                                                                      01                  000665
   769         update(e) PFHS_ENTR pfdso; // update record                                              01                  000666
   770      endif;                                                                                     E01                  000667
   771   endsr; // chgSfFields                                                                                              000668
   772                                                                                                                      000669
   773   // -------------------------------------------------------------------                                             000670
   774   // copy record                                                                                                     000671
   775   // -------------------------------------------------------------------                                             000672
   776   begsr copyRec;                                                                                                     000673
   777                                                                                                                      000674
   778      setLL *hival PFHS_ENT;     // set end of db file                                                                000675
   779      readp(n) PFHS_ENT pfdsi;    // read last db record                                                              000676
   780      SEQNBR = pfdsi.SEQNBR + 10; // add 10 to sequence number                                                        000677
   781      chain  dfdssf.SEQNBRH PFHS_ENT pfdsi; // read database record for original                                      000678
   782                                       // seq. number that was saved when                                             000679
   783                                       // subfile was filled                                                          000680
   784      eval-corr pfdso = pfdsi;   // copy data from input to output data structur                                      000681
   785      pfdso.SEQNBR = SEQNBR;     // new seq. number                                                                   000682
   786      exsr createMasks;          // create masks for data fields                                                      000683
   787      write(e) PFHS_ENTR pfdso;  // write new db record with data from window                                         000684
   788                                                                                                                      000685
   789   endsr; // copyRec                                                                                                  000686
   790                                                                                                                      000687
   791   // -------------------------------------------------------------------                                             000688
   792   // delete record                                                                                                   000689
   793   // -------------------------------------------------------------------                                             000690
   794   begsr deleteRec;                                                                                                   000691
   795      delete dfdssf.SEQNBR PFHS_ENT;                                                                                  000692
   796   endsr; // deleteRec                                                                                                000693
   797                                                                                                                      000694
   798   // -------------------------------------------------------------------                                             000695
   799   // create masks of database fields                                                                                 000696
   800   // -------------------------------------------------------------------                                             000697
   801   begsr createMasks;                                                                                                 000698
   802                                                                                                                      000699
   803   // get info of fields in db filter file                                                                            000700
   804   cmdText =                                                                                                          000701
   805    'DSPFFD FILE(PFHS_ENT) OUTPUT(*OUTFILE) +                                                                         000702
   806     OUTFILE(QTEMP/DSPFFD)';                                                                                          000703
   807   cmdLen = %len(%trimr(cmdText));                                                                                    000704
   808  /end-free                                                                                                           000705
   809  *   execute command DSPFFD PFHS_ENT                                                                _MOD             000706
   810 c                   call      'QCMDEXC'                                                                              000707
   811 c                   parm                    cmdText                                                                  000708
   812 c                   parm                    cmdLen                                                                   000709
   813                                                                                                                      000710
   814  /free                                                                                                               000711



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     17

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   815   open QADSPFFD;      // open file with field descriptions                                                           000712
   816                                                                                                                      000713
   817   // 4 felds skipped: SEQNBR, TYPE, CCSIDJOB, INEX                                                                   000714
   818   setll 5 QADSPFFD;   // read 5th data field                                                                         000715
   819   read QADSPFFD;      // read data field description                                                                 000716
   820                                                                                                                      000717
   821   // WHFLDN is "number of fields in record"                                                                          000718
   822   limit = (WHFLDN - 4)/2;   // first 4 fields are not processed                                                      000719
   823   idx = 0;                                                                                                           000720
   824   dow not %eof and idx < limit;                                                                 B01                  000721
   825      idx +=1;                                                                                    01                  000722
   826             // WHRLEN is "record format length"                                                                      000723
   827             // WHFLDE is "external field name"                                                                       000724
   828             // WHIBO is "input buffer offset"                                                                        000725
   829             // WHFLDB is "field length in bytes"                                                                     000726
   830      // extract data field into an array                                                                             000727
   831      fld  = %subst(pfdso: WHIBO: WHFLDB);  // data field                                         01                  000728
   832                                                                                                                      000729
   833      // if the field contains all blanks, mask will be all binary zeros                                              000730
   834      if %subst(fld: 1: WHFLDB) = *blank;                                                        B02                  000731
   835         mask = *allX'00';                                                                        02                  000732
   836      else;                                                                                      X02                  000733
   837      // set mask according to individual characters in the field                                                     000734
   838         // create mask bytes according to data field bytes                                                           000735
   839         for pos = 1 by 1 to WHFLDB; // cycle over all field bytes                               B03                  000736
   840            if fa(pos) = '?';                                                                    B04                  000737
   841               ma(pos) = X'00';                                                                   04                  000738
   842            elseif fa(pos) = '>';                                                                X04                  000739
   843               %subst(mask: pos) = *allX'00';                                                     04                  000740
   844               leave;                                                                             04                  000741
   845            else;                                                                                X04                  000742
   846               ma(pos) = X'FF';                                                                   04                  000743
   847            endif;                                                                               E04                  000744
   848         endfor;                                                                                 E03                  000745
   849      endif;                                                                                     E02                  000746
   850      // Put mask to the mask field (which is in the same relative position                                           000747
   851      // against data field (+ length of all data fields but 4).                                                      000748
   852      // Mask has the same length as the data field                                                                   000749
   853      pos = WHIBO + (WHRLEN-2-2-4-2)/2; // subtract lengths of 4 fields:                          01                  000750
   854                                        // SEQNBR, TYPE, CCSIDJOB, INEX                                               000751
   855      %subst(pfdso: pos: WHFLDB) = %subst(mask: 1: WHFLDB);                                       01                  000752
   856      // read next data field description                                                                             000753
   857      read QADSPFFD;                                                                              01                  000754
   858                                                                                                                      000755
   859   enddo;                                                                                        E01                  000756
   860   close QADSPFFD;     // close file with field descriptions                                                          000757
   861                                                                                                                      000758
   862   endsr; // createMasks                                                                                              000759
   863                                                                                                                      000760
   864   // -------------------------------------------------------------------                                             000761
   865   // retrieve current job CCSID                                                                                      000762
   866   // -------------------------------------------------------------------                                             000763
   867   begsr rtvJobCCSID;                                                                                                 000764
   868                                                                                                                      000765
   869   /end-free                                                                                                          000766
   870 c                   call      'QUSRJOBI'                                                                             000767



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     18

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   871 c                   parm                    QUSI0400                                                                 000768
   872 c                   parm                    len_bin                        result length                             000769
   873 c                   parm                    format                         format name                               000770
   874 c                   parm                    jobname                        job name                                  000771
   875 c                   parm                    int_job_id                     internal job ID                           000772
   876  /free                                                                                                               000773
   877                                                                                                                      000774
   878      CCSIDJOB = QUSCCSID07;  // current job CCSID                                                                    000775
   879   endsr;  // rtvJobCCSID                                                                                             000776
   880                                                                                                                      000777
   881   // -------------------------------------------------------------------                                             000778
   882   //   display HELP (for HSTSF + HSTCT)                                                                              000779
   883   // -------------------------------------------------------------------                                             000780
   884   begsr dspHelp;                                                                                                     000781
   885      write HELP;                                                                                                     000782
   886      read  HELP;                                                                                                     000783
   887   endsr;  // dspHelp                                                                                                 000784
   888                                                                                                                      000785
   889   // -------------------------------------------------------------------                                             000786
   890   //   display HELPW (for HSTW)                                                                                      000787
   891   // -------------------------------------------------------------------                                             000788
   892   begsr dspHelpw;                                                                                                    000789
   893      write HELPW;                                                                                                    000790
   894      read  HELPW;                                                                                                    000791
   895   endsr;  // dspHelpw                                                                                                000792
   896                                                                                                                      000793
   897   // -------------------------------------------------------------------                                             000794
   898   //   display HELPW2 (for HSTW2)                                                                                    000795
   899   // -------------------------------------------------------------------                                             000796
   900   begsr dspHelpw2;                                                                                                   000797
   901      write HELPW2;                                                                                                   000798
   902      read  HELPW2;                                                                                                   000799
   903      if *in01;                                                                                  B01                  000800
   904         exsr dspHelpw2A;                                                                         01                  000801
   905      endif;                                                                                     E01                  000802
   906   endsr;  // dspHelpw2                                                                                               000803
   907                                                                                                                      000804
   908   // -------------------------------------------------------------------                                             000805
   909   //   display HELPW2A (for HELPW2)                                                                                  000806
   910   // -------------------------------------------------------------------                                             000807
   911   begsr dspHelpw2A;                                                                                                  000808
   912      write HELPW2A;                                                                                                  000809
   913      read  HELPW2A;                                                                                                  000810
   914      if *in01;                                                                                  B01                  000811
   915         exsr dspHelpw2B;                                                                         01                  000812
   916      endif;                                                                                     E01                  000813
   917   endsr;  // dspHelpw2A                                                                                              000814
   918                                                                                                                      000815
   919   // -------------------------------------------------------------------                                             000816
   920   //   display HELPW2B (for HELPW2A)                                                                                 000817
   921   // -------------------------------------------------------------------                                             000818
   922   begsr dspHelpw2B;                                                                                                  000819
   923      write HELPW2B;                                                                                                  000820
   924      read  HELPW2B;                                                                                                  000821
   925      if *in01;                                                                                  B01                  000822
   926         exsr dspHelpw2C;                                                                         01                  000823



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     19

Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   927      endif;                                                                                     E01                  000824
   928   endsr;  // dspHelpw2B                                                                                              000825
   929                                                                                                                      000826
   930   // -------------------------------------------------------------------                                             000827
   931   //   display HELPW2C (for HELPW2B)                                                                                 000828
   932   // -------------------------------------------------------------------                                             000829
   933   begsr dspHelpw2C;                                                                                                  000830
   934      write HELPW2C;                                                                                                  000831
   935      read  HELPW2C;                                                                                                  000832
   936      if *in01;                                                                                  B01                  000833
   937         exsr dspHelpw2D;                                                                         01                  000834
   938      endif;                                                                                     E01                  000835
   939   endsr;  // dspHelpw2C                                                                                              000836
   940                                                                                                                      000837
   941   // -------------------------------------------------------------------                                             000838
   942   //   display HELPW2D (for HELPW2C)                                                                                 000839
   943   // -------------------------------------------------------------------                                             000840
   944   begsr dspHelpw2D;                                                                                                  000841
   945      write HELPW2D;                                                                                                  000842
   946      read  HELPW2D;                                                                                                  000843
   947   endsr;  // dspHelpw2D                                                                                              000844
   948                                                                                                                      000845
   949   // -------------------------------------------------------------------                                             000846
   950   //   display HELPW3 (for HSTW3)                                                                                    000847
   951   // -------------------------------------------------------------------                                             000848
   952   begsr dspHelpw3;                                                                                                   000849
   953      write HELPW3;                                                                                                   000850
   954      read  HELPW3;                                                                                                   000851
   955   endsr;  // dspHelpw3                                                                                               000852

       * * * * *   E N D   O F   S O U R C E   * * * * *



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     20

          A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s

 Msg id  Sv Number Seq     Message text
*RNF7030 30    392 000289  The name or indicator CCSIDJOB is not defined.
*RNF7030 30    392 000289  The name or indicator CCSIDJOB is not defined.
*RNF7030 30    262 000159  The name or indicator CSR is not defined.
*RNF7030 30     24 000024  The name or indicator DFDSSF is not defined.
*RNF7030 30     25 000025  The name or indicator DFDSWI is not defined.
*RNF7030 30     27 000027  The name or indicator DFDSWI2 is not defined.
*RNF7030 30     29 000029  The name or indicator DFDSWI3 is not defined.
*RNF7030 30     26 000026  The name or indicator DFDSWO is not defined.
*RNF7030 30     28 000028  The name or indicator DFDSWO2 is not defined.
*RNF7030 30     30 000030  The name or indicator DFDSWO3 is not defined.
*RNF7089 00     12 000012  RPG provides Separate-Indicator area for file DFHS_ENT.
*RNF7030 30    750 000647  The name or indicator FRSTTXT is not defined.
*RNF7030 30    194 000091  The name or indicator FUNCKEYS is not defined.
*RNF7030 30    885 000782  The name or indicator HELP is not defined.
*RNF7030 30    893 000790  The name or indicator HELPW is not defined.
*RNF7030 30    901 000798  The name or indicator HELPW2 is not defined.
*RNF7030 30    912 000809  The name or indicator HELPW2A is not defined.
*RNF7030 30    923 000820  The name or indicator HELPW2B is not defined.
*RNF7030 30    934 000831  The name or indicator HELPW2C is not defined.
*RNF7030 30    945 000842  The name or indicator HELPW2D is not defined.
*RNF7030 30    953 000850  The name or indicator HELPW3 is not defined.
*RNF7030 30    195 000092  The name or indicator HSTCT is not defined.
*RNF7030 30     24 000024  The name or indicator HSTSF is not defined.
*RNF7030 30     25 000025  The name or indicator HSTW is not defined.
*RNF7030 30     27 000027  The name or indicator HSTW2 is not defined.
*RNF7030 30     29 000029  The name or indicator HSTW3 is not defined.
*RNF7030 30     44 000044  The name or indicator INEX is not defined.
*RNF7030 30    310 000207  The name or indicator INEX is not defined.
*RNF7030 30    336 000233  The name or indicator INEX is not defined.
*RNF7030 30    393 000290  The name or indicator INEX is not defined.
*RNF7030 30    422 000319  The name or indicator INEX is not defined.
*RNF7030 30    481 000378  The name or indicator INEX is not defined.
*RNF7030 30     44 000044  The name or indicator INEX2 is not defined.
*RNF7030 30    345 000242  The name or indicator IN01 is not defined.
*RNF7030 30    431 000328  The name or indicator IN01 is not defined.
*RNF7030 30    490 000387  The name or indicator IN01 is not defined.
*RNF7030 30    341 000238  The name or indicator IN03 is not defined.
*RNF7030 30    427 000324  The name or indicator IN03 is not defined.
*RNF7030 30    486 000383  The name or indicator IN03 is not defined.
*RNF7030 30    348 000245  The name or indicator IN07 is not defined.
*RNF7030 30    434 000331  The name or indicator IN07 is not defined.
*RNF7030 30    299 000196  The name or indicator IN12 is not defined.
*RNF7030 30    356 000253  The name or indicator IN12 is not defined.
*RNF7030 30    356 000253  The name or indicator IN12 is not defined.
*RNF7030 30    290 000187  The name or indicator IN80 is not defined.
*RNF7030 30    291 000188  The name or indicator IN81 is not defined.
*RNF7030 30    292 000189  The name or indicator IN82 is not defined.
*RNF7030 30    365 000262  The name or indicator IN99 is not defined.
*RNF7030 30    453 000350  The name or indicator IN99 is not defined.
*RNF7030 30    504 000401  The name or indicator IN99 is not defined.
*RNF7030 30    750 000647  The name or indicator LENTXT1 is not defined.
*RNF7030 30    752 000649  The name or indicator LENTXT2 is not defined.
*RNF7030 30    264 000161  The name or indicator OPTION is not defined.
*RNF7030 30     22 000022  The name or indicator PFDSI is not defined.
*RNF7030 30     23 000023  The name or indicator PFDSO is not defined.



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     21

*RNF7030 30     22 000022  The name or indicator PFHS_ENTR is not defined.
*RNF7066 00     15 000015  Record-Format QWHDRFFD not used for input or output.
*RNF7030 30    752 000649  The name or indicator SECTXT is not defined.
*RNF7030 30     43 000043  The name or indicator SEQNBR is not defined.
*RNF7030 30    269 000166  The name or indicator SEQNBR is not defined.
*RNF7030 30    296 000193  The name or indicator SEQNBR is not defined.
*RNF7030 30    387 000284  The name or indicator SEQNBR is not defined.
*RNF7030 30    269 000166  The name or indicator SEQNBRH is not defined.
*RNF7030 30     43 000043  The name or indicator SEQNBR2 is not defined.
*RNF7030 30    749 000646  The name or indicator STRPOS1 is not defined.
*RNF7030 30    751 000648  The name or indicator STRPOS2 is not defined.
*RNF7030 30    335 000232  The name or indicator TYPE is not defined.
*RNF7030 30    335 000232  The name or indicator TYPE is not defined.
*RNF7030 30    391 000288  The name or indicator TYPE is not defined.
*RNF7030 30    421 000318  The name or indicator TYPE is not defined.
*RNF7030 30    480 000377  The name or indicator TYPE is not defined.
*RNF7503 30    194 000091  Expression contains an operand that is not defined.
*RNF7503 30    195 000092  Expression contains an operand that is not defined.
*RNF7503 30    198 000095  Expression contains an operand that is not defined.
*RNF7503 30    200 000097  Expression contains an operand that is not defined.
*RNF7503 30    204 000101  Expression contains an operand that is not defined.
*RNF7503 30    207 000104  Expression contains an operand that is not defined.
*RNF7503 30    217 000114  Expression contains an operand that is not defined.
*RNF7503 30    218 000115  Expression contains an operand that is not defined.
*RNF7503 30    258 000155  Expression contains an operand that is not defined.
*RNF7503 30    262 000159  Expression contains an operand that is not defined.
*RNF7503 30    264 000161  Expression contains an operand that is not defined.
*RNF7503 30    265 000162  Expression contains an operand that is not defined.
*RNF7503 30    266 000163  Expression contains an operand that is not defined.
*RNF7503 30    269 000166  Expression contains an operand that is not defined.
*RNF7503 30    270 000167  Expression contains an operand that is not defined.
*RNF7503 30    271 000168  Expression contains an operand that is not defined.
*RNF7503 30    272 000169  Expression contains an operand that is not defined.
*RNF7503 30    284 000181  Expression contains an operand that is not defined.
*RNF7503 30    286 000183  Expression contains an operand that is not defined.
*RNF7503 30    290 000187  Expression contains an operand that is not defined.
*RNF7503 30    291 000188  Expression contains an operand that is not defined.
*RNF7503 30    292 000189  Expression contains an operand that is not defined.
*RNF7503 30    293 000190  Expression contains an operand that is not defined.
*RNF7503 30    295 000192  Expression contains an operand that is not defined.
*RNF7503 30    296 000193  Expression contains an operand that is not defined.
*RNF7503 30    299 000196  Expression contains an operand that is not defined.
*RNF7503 30    300 000197  Expression contains an operand that is not defined.
*RNF7503 30    302 000199  Expression contains an operand that is not defined.
*RNF7503 30    303 000200  Expression contains an operand that is not defined.
*RNF7503 30    305 000202  Expression contains an operand that is not defined.
*RNF7503 30    307 000204  Expression contains an operand that is not defined.
*RNF7503 30    309 000206  Expression contains an operand that is not defined.
*RNF7503 30    313 000210  Expression contains an operand that is not defined.
*RNF7503 30    317 000214  Expression contains an operand that is not defined.
*RNF7503 30    318 000215  Expression contains an operand that is not defined.
*RNF7503 30    319 000216  Expression contains an operand that is not defined.
*RNF7503 30    320 000217  Expression contains an operand that is not defined.
*RNF7503 30    322 000219  Expression contains an operand that is not defined.
*RNF7503 30    331 000228  Expression contains an operand that is not defined.
*RNF7503 30    332 000229  Expression contains an operand that is not defined.
*RNF7503 30    333 000230  Expression contains an operand that is not defined.
*RNF7503 30    334 000231  Expression contains an operand that is not defined.



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     22

*RNF7503 30    335 000232  Expression contains an operand that is not defined.
*RNF7503 30    336 000233  Expression contains an operand that is not defined.
*RNF7503 30    339 000236  Expression contains an operand that is not defined.
*RNF7503 30    340 000237  Expression contains an operand that is not defined.
*RNF7503 30    341 000238  Expression contains an operand that is not defined.
*RNF7503 30    343 000240  Expression contains an operand that is not defined.
*RNF7503 30    345 000242  Expression contains an operand that is not defined.
*RNF7503 30    348 000245  Expression contains an operand that is not defined.
*RNF7503 30    356 000253  Expression contains an operand that is not defined.
*RNF7503 30    365 000262  Expression contains an operand that is not defined.
*RNF7503 30    384 000281  Expression contains an operand that is not defined.
*RNF7503 30    385 000282  Expression contains an operand that is not defined.
*RNF7503 30    386 000283  Expression contains an operand that is not defined.
*RNF7503 30    387 000284  Expression contains an operand that is not defined.
*RNF7503 30    390 000287  Expression contains an operand that is not defined.
*RNF7503 30    391 000288  Expression contains an operand that is not defined.
*RNF7503 30    392 000289  Expression contains an operand that is not defined.
*RNF7503 30    393 000290  Expression contains an operand that is not defined.
*RNF7503 30    399 000296  Expression contains an operand that is not defined.
*RNF7503 30    400 000297  Expression contains an operand that is not defined.
*RNF7503 30    407 000304  Expression contains an operand that is not defined.
*RNF7503 30    409 000306  Expression contains an operand that is not defined.
*RNF7503 30    410 000307  Expression contains an operand that is not defined.
*RNF7503 30    412 000309  Expression contains an operand that is not defined.
*RNF7503 30    413 000310  Expression contains an operand that is not defined.
*RNF7503 30    421 000318  Expression contains an operand that is not defined.
*RNF7503 30    422 000319  Expression contains an operand that is not defined.
*RNF7503 30    425 000322  Expression contains an operand that is not defined.
*RNF7503 30    426 000323  Expression contains an operand that is not defined.
*RNF7503 30    427 000324  Expression contains an operand that is not defined.
*RNF7503 30    429 000326  Expression contains an operand that is not defined.
*RNF7503 30    431 000328  Expression contains an operand that is not defined.
*RNF7503 30    434 000331  Expression contains an operand that is not defined.
*RNF7503 30    437 000334  Expression contains an operand that is not defined.
*RNF7503 30    445 000342  Expression contains an operand that is not defined.
*RNF7503 30    446 000343  Expression contains an operand that is not defined.
*RNF7503 30    447 000344  Expression contains an operand that is not defined.
*RNF7503 30    449 000346  Expression contains an operand that is not defined.
*RNF7503 30    453 000350  Expression contains an operand that is not defined.
*RNF7503 30    466 000363  Expression contains an operand that is not defined.
*RNF7503 30    468 000365  Expression contains an operand that is not defined.
*RNF7503 30    469 000366  Expression contains an operand that is not defined.
*RNF7503 30    471 000368  Expression contains an operand that is not defined.
*RNF7503 30    472 000369  Expression contains an operand that is not defined.
*RNF7503 30    480 000377  Expression contains an operand that is not defined.
*RNF7503 30    481 000378  Expression contains an operand that is not defined.
*RNF7503 30    484 000381  Expression contains an operand that is not defined.
*RNF7503 30    485 000382  Expression contains an operand that is not defined.
*RNF7503 30    486 000383  Expression contains an operand that is not defined.
*RNF7503 30    488 000385  Expression contains an operand that is not defined.
*RNF7503 30    490 000387  Expression contains an operand that is not defined.
*RNF7503 30    496 000393  Expression contains an operand that is not defined.
*RNF7503 30    497 000394  Expression contains an operand that is not defined.
*RNF7503 30    498 000395  Expression contains an operand that is not defined.
*RNF7503 30    500 000397  Expression contains an operand that is not defined.
*RNF7503 30    504 000401  Expression contains an operand that is not defined.
*RNF7503 30    517 000414  Expression contains an operand that is not defined.
*RNF7503 30    519 000416  Expression contains an operand that is not defined.



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     23

*RNF7503 30    520 000417  Expression contains an operand that is not defined.
*RNF7503 30    522 000419  Expression contains an operand that is not defined.
*RNF7503 30    523 000420  Expression contains an operand that is not defined.
*RNF7503 30    533 000430  Expression contains an operand that is not defined.
*RNF7503 30    543 000440  Expression contains an operand that is not defined.
*RNF7503 30    544 000441  Expression contains an operand that is not defined.
*RNF7503 30    548 000445  Expression contains an operand that is not defined.
*RNF7503 30    549 000446  Expression contains an operand that is not defined.
*RNF7503 30    559 000456  Expression contains an operand that is not defined.
*RNF7503 30    570 000467  Expression contains an operand that is not defined.
*RNF7503 30    571 000468  Expression contains an operand that is not defined.
*RNF7503 30    572 000469  Expression contains an operand that is not defined.
*RNF7503 30    575 000472  Expression contains an operand that is not defined.
*RNF7503 30    576 000473  Expression contains an operand that is not defined.
*RNF7503 30    577 000474  Expression contains an operand that is not defined.
*RNF7503 30    579 000476  Expression contains an operand that is not defined.
*RNF7503 30    580 000477  Expression contains an operand that is not defined.
*RNF7503 30    582 000479  Expression contains an operand that is not defined.
*RNF7503 30    585 000482  Expression contains an operand that is not defined.
*RNF7503 30    588 000485  Expression contains an operand that is not defined.
*RNF7503 30    597 000494  Expression contains an operand that is not defined.
*RNF7503 30    611 000508  Expression contains an operand that is not defined.
*RNF7503 30    615 000512  Expression contains an operand that is not defined.
*RNF7503 30    616 000513  Expression contains an operand that is not defined.
*RNF7503 30    617 000514  Expression contains an operand that is not defined.
*RNF7503 30    618 000515  Expression contains an operand that is not defined.
*RNF7503 30    623 000520  Expression contains an operand that is not defined.
*RNF7503 30    624 000521  Expression contains an operand that is not defined.
*RNF7503 30    625 000522  Expression contains an operand that is not defined.
*RNF7503 30    633 000530  Expression contains an operand that is not defined.
*RNF7503 30    634 000531  Expression contains an operand that is not defined.
*RNF7503 30    637 000534  Expression contains an operand that is not defined.
*RNF7503 30    638 000535  Expression contains an operand that is not defined.
*RNF7503 30    639 000536  Expression contains an operand that is not defined.
*RNF7503 30    642 000539  Expression contains an operand that is not defined.
*RNF7503 30    643 000540  Expression contains an operand that is not defined.
*RNF7503 30    645 000542  Expression contains an operand that is not defined.
*RNF7503 30    648 000545  Expression contains an operand that is not defined.
*RNF7503 30    652 000549  Expression contains an operand that is not defined.
*RNF7503 30    661 000558  Expression contains an operand that is not defined.
*RNF7503 30    674 000571  Expression contains an operand that is not defined.
*RNF7503 30    678 000575  Expression contains an operand that is not defined.
*RNF7503 30    679 000576  Expression contains an operand that is not defined.
*RNF7503 30    680 000577  Expression contains an operand that is not defined.
*RNF7503 30    681 000578  Expression contains an operand that is not defined.
*RNF7503 30    686 000583  Expression contains an operand that is not defined.
*RNF7503 30    687 000584  Expression contains an operand that is not defined.
*RNF7503 30    688 000585  Expression contains an operand that is not defined.
*RNF7503 30    696 000593  Expression contains an operand that is not defined.
*RNF7503 30    697 000594  Expression contains an operand that is not defined.
*RNF7503 30    700 000597  Expression contains an operand that is not defined.
*RNF7503 30    701 000598  Expression contains an operand that is not defined.
*RNF7503 30    702 000599  Expression contains an operand that is not defined.
*RNF7503 30    704 000601  Expression contains an operand that is not defined.
*RNF7503 30    705 000602  Expression contains an operand that is not defined.
*RNF7503 30    707 000604  Expression contains an operand that is not defined.
*RNF7503 30    715 000612  Expression contains an operand that is not defined.
*RNF7503 30    728 000625  Expression contains an operand that is not defined.



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     24

*RNF7503 30    732 000629  Expression contains an operand that is not defined.
*RNF7503 30    733 000630  Expression contains an operand that is not defined.
*RNF7503 30    734 000631  Expression contains an operand that is not defined.
*RNF7503 30    739 000636  Expression contains an operand that is not defined.
*RNF7503 30    740 000637  Expression contains an operand that is not defined.
*RNF7503 30    741 000638  Expression contains an operand that is not defined.
*RNF7503 30    749 000646  Expression contains an operand that is not defined.
*RNF7503 30    750 000647  Expression contains an operand that is not defined.
*RNF7503 30    751 000648  Expression contains an operand that is not defined.
*RNF7503 30    752 000649  Expression contains an operand that is not defined.
*RNF7503 30    759 000656  Expression contains an operand that is not defined.
*RNF7503 30    760 000657  Expression contains an operand that is not defined.
*RNF7503 30    761 000658  Expression contains an operand that is not defined.
*RNF7503 30    765 000662  Expression contains an operand that is not defined.
*RNF7503 30    766 000663  Expression contains an operand that is not defined.
*RNF7503 30    767 000664  Expression contains an operand that is not defined.
*RNF7503 30    768 000665  Expression contains an operand that is not defined.
*RNF7503 30    769 000666  Expression contains an operand that is not defined.
*RNF7503 30    778 000675  Expression contains an operand that is not defined.
*RNF7503 30    779 000676  Expression contains an operand that is not defined.
*RNF7503 30    780 000677  Expression contains an operand that is not defined.
*RNF7503 30    781 000678  Expression contains an operand that is not defined.
*RNF7503 30    784 000681  Expression contains an operand that is not defined.
*RNF7503 30    785 000682  Expression contains an operand that is not defined.
*RNF7503 30    787 000684  Expression contains an operand that is not defined.
*RNF7503 30    795 000692  Expression contains an operand that is not defined.
*RNF7503 30    831 000728  Expression contains an operand that is not defined.
*RNF7503 30    855 000752  Expression contains an operand that is not defined.
*RNF7503 30    878 000775  Expression contains an operand that is not defined.
*RNF7503 30    885 000782  Expression contains an operand that is not defined.
*RNF7503 30    886 000783  Expression contains an operand that is not defined.
*RNF7503 30    893 000790  Expression contains an operand that is not defined.
*RNF7503 30    894 000791  Expression contains an operand that is not defined.
*RNF7503 30    901 000798  Expression contains an operand that is not defined.
*RNF7503 30    902 000799  Expression contains an operand that is not defined.
*RNF7503 30    903 000800  Expression contains an operand that is not defined.
*RNF7503 30    912 000809  Expression contains an operand that is not defined.
*RNF7503 30    913 000810  Expression contains an operand that is not defined.
*RNF7503 30    914 000811  Expression contains an operand that is not defined.
*RNF7503 30    923 000820  Expression contains an operand that is not defined.
*RNF7503 30    924 000821  Expression contains an operand that is not defined.
*RNF7503 30    925 000822  Expression contains an operand that is not defined.
*RNF7503 30    934 000831  Expression contains an operand that is not defined.
*RNF7503 30    935 000832  Expression contains an operand that is not defined.
*RNF7503 30    936 000833  Expression contains an operand that is not defined.
*RNF7503 30    945 000842  Expression contains an operand that is not defined.
*RNF7503 30    946 000843  Expression contains an operand that is not defined.
*RNF7503 30    953 000850  Expression contains an operand that is not defined.
*RNF7503 30    954 000851  Expression contains an operand that is not defined.
*RNF7030 30    207 000104  The name or indicator *IN01 is not defined.
*RNF7030 30    198 000095  The name or indicator *IN03 is not defined.
*RNF7030 30    200 000097  The name or indicator *IN06 is not defined.
*RNF7030 30    198 000095  The name or indicator *IN12 is not defined.
*RNF7030 30    204 000101  The name or indicator *IN14 is not defined.

 * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     25

                          C r o s s   R e f e r e n c e

      File and Record References:

         File              Device             References (D=Defined)
           Record
         DFHS_ENT          WORKSTN                12D
         PFHS_ENT          DISK                   10D    187     230     240
                                                 265     266     272     385
                                                 386     407     466     517
                                                 544     549     611     674
                                                 728     761     778     779
                                                 781     795
         QADSPFFD          DISK                   15D    815     818     819
                                                 857     860
           QWHDRFFD                               15D     81

      Global Field References:

         Field             Attributes         References (D=Defined M=Modified)
         *INLR             N(1)                  248M
*RNF7030 *IN01             **UNDEF**             207     903     914     925
                                                 936
*RNF7030 *IN03             **UNDEF**             198
*RNF7030 *IN06             **UNDEF**             200
*RNF7030 *IN12             **UNDEF**             198
*RNF7030 *IN14             **UNDEF**             204
         *IN51             N(1)                  274M    283
         *IN56             N(1)                  257M    259M
         *IN80             N(1)                  289     317     532M    537M
         *IN81             N(1)                  289     318     542M    551M
         *IN82             N(1)                  289     319     558M    561M
         *IN89             N(1)                  281M    538M    552M    562M
*RNF7030 CCSIDJOB          **UNDEF**             392     410     469     520
                                                 618     681     734     878M
         CHGSFFIELDS       BEGSR                 308     758D
         CHKSFFIELDS       BEGSR                 287     530D
         CLEARFILE         BEGSR                 205     228D
         CMDLEN            P(15,5)                47D    237M    807M    812M
         CMDTEXT           A(200)                 46D    233M    236M    804M
                                                 807     811M
         COPY              CONST                  35D    305     535
         COPYREC           BEGSR                 306     776D
         CREATEMASKS       BEGSR                 397     411     470     521
                                                 622     685     738     786
                                                 801D
*RNF7030 CSR               **UNDEF**             262M    286M
         CTR               I(10,0)                50D    337M    359M    364M
                                                 365     573M    591M    596M
                                                 597
         CTR2              I(10,0)                51D    423M    440M    452M
                                                 453     635M    651M    655M
                                                 660M    661
         CTR3              I(10,0)                52D    482M    503M    504
                                                 698M    714M    715
         DELETE            CONST                  34D    303     534
         DELETEREC         BEGSR                 304     794D
*RNF7030 DFDSSF            **UNDEF**              24D    264M    269M    270M



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     26

                                                 271     284M    290M    291M
                                                 292M    293     295M    296
                                                 296     300M    302     303
                                                 305     307     309     309
                                                 310     310     313     317M
                                                 318M    319M    320     322M
                                                 533     534     535     536
                                                 543     544     548     559
                                                 560     570     571     580M
                                                 611     625M    633     643M
                                                 674     688M    696     705M
                                                 728     741M    759     760
                                                 761     781     795
*RNF7030 DFDSWI            **UNDEF**              25D    299     340M    341
                                                 343     345     348     365
                                                 390     400     409     413
                                                 576M    577     579     582
                                                 585     597     617     624
*RNF7030 DFDSWI2           **UNDEF**              27D    356     426M    427
                                                 429     431     434     445
                                                 449     453     468     472
                                                 588     638M    639     642
                                                 645     648     661     680
                                                 687
*RNF7030 DFDSWI3           **UNDEF**              29D    356     437     485M
                                                 486     488     490     496
                                                 500     504     519     523
                                                 588     652     701M    702
                                                 704     707     715     733
                                                 740     766
*RNF7030 DFDSWO            **UNDEF**              26D    332M    335M    336M
                                                 339     400M    413M    472M
                                                 523M    571M    572M    575
                                                 580     624M
*RNF7030 DFDSWO2           **UNDEF**              28D    333M    421M    422M
                                                 425     449M    633M    634M
                                                 637     643     687M
*RNF7030 DFDSWO3           **UNDEF**              30D    334M    480M    481M
                                                 484     500M    696M    697M
                                                 700     705     740M
         DSPHELP           BEGSR                 208     884D
         DSPHELPW          BEGSR                 346     583     892D
         DSPHELPW2         BEGSR                 432     646     900D
         DSPHELPW2A        BEGSR                 904     911D
         DSPHELPW2B        BEGSR                 915     922D
         DSPHELPW2C        BEGSR                 926     933D
         DSPHELPW2D        BEGSR                 937     944D
         DSPHELPW3         BEGSR                 491     708     952D
         EDIT              CONST                  33D    293     533
         EDITREC           BEGSR                 294     569D
         EDITREC2          BEGSR                 587     632D
         EDITREC3          BEGSR                 650     695D
         ENDPGM            BEGSR                 199     247D    342     428
                                                 487     578     640     703
         EXCLUDE           CONST                  37D    560
         FA(2000)          A(1)                   56D    840     842
         FILLSFL           BEGSR                 192     203     206     213
                                                 255D



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     27

         FLD               DS(2000)               55D    831M    834
         FORMAT            A(8)                   62D    873M
*RNF7030 FUNCKEYS          **UNDEF**             194     217
*RNF7030 HELP              **UNDEF**             885     886
*RNF7030 HELPW             **UNDEF**             893     894
*RNF7030 HELPW2            **UNDEF**             901     902
*RNF7030 HELPW2A           **UNDEF**             912     913
*RNF7030 HELPW2B           **UNDEF**             923     924
*RNF7030 HELPW2C           **UNDEF**             934     935
*RNF7030 HELPW2D           **UNDEF**             945     946
*RNF7030 HELPW3            **UNDEF**             953     954
*RNF7030 HSTCT             **UNDEF**             195     218     258
*RNF7030 HSTSF             **UNDEF**              24     271     284     302
                                                 313     320     322
*RNF7030 HSTW              **UNDEF**              25      26     339     340
                                                 575     576
*RNF7030 HSTW2             **UNDEF**              27      28     425     426
                                                 637     638
*RNF7030 HSTW3             **UNDEF**              29      30     484     485
                                                 700     701
         IDX               U(10,0)                49D    823M    824     825M
         IDXSFL            U(10,0)                40D    263M    268M    274
                                                 286
         INCLUDE           CONST                  36D    336     393     422
                                                 447     481     498     559
*RNF7030 INEX              **UNDEF**              44
*RNF7030 INEX2             **UNDEF**              44D    760M    768
         INT_JOB_ID        A(16)                  64D    875M
         JOBNAME           A(26)                  63D    874M
         LEN_BIN           I(10,0)                61D    872M
         LIMIT             U(10,0)                54D    822M    824
         MA(2000)          A(1)                   58D    841M    846M
         MASK              DS(2000)               57D    835M    843M    855
         NEWREC            BEGSR                 202     330D
         NEWREC2           BEGSR                 355     420D
         NEWREC3           BEGSR                 436     479D
*RNF7030 PFDSI             **UNDEF**              22D    266M    269     270
                                                 272M    384M    386M    387
                                                 544M    611M    616     674M
                                                 679     728M    761M    765
                                                 779M    780     781M    784
*RNF7030 PFDSO             **UNDEF**              23D    300     331M    387M
                                                 390M    391M    392M    393M
                                                 399     407     409M    410M
                                                 412     445M    446M    447M
                                                 466     468M    469M    471
                                                 496M    497M    498M    517
                                                 519M    520M    522     615M
                                                 616M    617M    618M    623
                                                 625     678M    679M    680M
                                                 681M    686     688     732M
                                                 733M    734M    739     741
                                                 749M    750M    750     751M
                                                 752M    752     765M    766M
                                                 767M    768M    769     784M
                                                 785M    787     831     855M
*RNF7030 PFHS_ENTR         **UNDEF**              22      23     399     412
                                                 471     522     623     686



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     28

                                                 739     769     787
         POS               U(10,0)                53D    839     840     841
                                                 842     843     846     853M
                                                 855
         POSITIONS         BEGSR                 394     620     683     736
                                                 748D
         PROCSFL           BEGSR                 211     280D
*RNF7031 QUSBA03           B(9,0)                 71D
*RNF7031 QUSBR03           B(9,0)                 69D
         QUSCCSID07        B(9,0)                 73D    878
         QUSI0400          DS(304)                61      67D    871M
         RECORDWRITTEN     N(1)                   42D    201M    349     351M
                                                 368     370M
         RTVJOBCCSID       BEGSR                 184     867D
*RNF7030 SEQNBR            **UNDEF**              43     780M    785
*RNF7030 SEQNBR2           **UNDEF**              43D    543M    548     549
                                                 570M    615     678     732
                                                 759M    767
         SHOULDFILLSFL     N(1)                   41D    212     282M    297M
                                                 311M    316M
*RNF7030 TYPE              **UNDEF**             335     391     421     446
                                                 480     497     572     634
                                                 697
         UPDNEWREC         BEGSR                 353     372     406D
         UPDNEWREC2        BEGSR                 435     456     465D
         UPDNEWREC3        BEGSR                 507     516D
         UPDREC            BEGSR                 586     598     601     610D
         UPDREC2           BEGSR                 649     664     673D
         UPDREC3           BEGSR                 718     727D
*RNF7031 WHALCH            A(1)                  177D
*RNF7031 WHALIS            A(30)                 118D
*RNF7031 WHALI2            A(258)                176D
*RNF7031 WHALLC            P(5,0)                141D
*RNF7031 WHALTY            A(1)                  117D
*RNF7031 WHBCHI            P(3,1)                128D
*RNF7031 WHBCNM            A(10)                 127D
*RNF7031 WHBCUH            P(5,2)                167D
*RNF7031 WHCDFL            A(10)                 148D
*RNF7031 WHCDFN            A(10)                 147D
*RNF7031 WHCFPS            P(4,1)                155D
*RNF7031 WHCFPW            P(4,1)                170D
*RNF7031 WHCHD1            A(20)                 106D
*RNF7031 WHCHD2            A(20)                 107D
*RNF7031 WHCHD3            A(20)                 108D
*RNF7031 WHCHRI            A(1)                  122D
*RNF7031 WHCNT             P(5,0)                 86D
*RNF7031 WHCRTD            A(7)                   84D
*RNF7031 WHCSHI            P(3,1)                126D
*RNF7031 WHCSID            P(5,0)                137D
*RNF7031 WHCSWD            P(3,1)                125D
*RNF7031 WHCTNT            A(1)                  123D
*RNF7031 WHDBFC            A(1)                  160D
*RNF7031 WHDBFI            A(1)                  161D
*RNF7031 WHDBLL            P(10,0)               157D
*RNF7031 WHDBOU            A(1)                  165D
*RNF7031 WHDBRC            A(1)                  164D
*RNF7031 WHDBRP            A(1)                  162D
*RNF7031 WHDBUL            A(10)                 159D



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     29

*RNF7031 WHDBUN            A(128)                158D
*RNF7031 WHDBWP            A(1)                  163D
*RNF7031 WHDCDF            A(10)                 149D
*RNF7031 WHDCDL            A(10)                 150D
*RNF7031 WHDCOL            P(3,0)                175D
*RNF7031 WHDFT             A(30)                 121D
*RNF7031 WHDFTL            P(2,0)                120D
*RNF7031 WHDROW            P(3,0)                174D
*RNF7031 WHDTTM            A(13)                  87D
*RNF7031 WHECDE            A(2)                  111D
*RNF7031 WHEWRD            A(32)                 112D
*RNF7031 WHFCPL            A(10)                 146D
*RNF7031 WHFCPN            A(10)                 145D
*RNF7031 WHFCSL            A(10)                 144D
*RNF7031 WHFCSN            A(10)                 143D
*RNF7031 WHFDSL            P(5,0)                153D
*RNF7031 WHFILE            A(10)                  82D
*RNF7031 WHFIOB            A(1)                  110D
         WHFLDB            P(5,0)                 97D    831     834     839
                                                 855     855
*RNF7031 WHFLDD            P(2,0)                 98D
*RNF7031 WHFLDE            A(10)                  94D
*RNF7031 WHFLDG            P(5,0)                152D
*RNF7031 WHFLDI            A(10)                  93D
         WHFLDN            P(5,0)                 91D    822
*RNF7031 WHFLDP            P(2,0)                 99D
*RNF7031 WHFLDT            A(1)                  109D
*RNF7031 WHFMT             A(4)                  138D
*RNF7031 WHFOBO            P(5,0)                 95D
*RNF7031 WHFONT            A(10)                 124D
*RNF7031 WHFPLN            A(10)                 183D
*RNF7031 WHFPPN            A(10)                 182D
*RNF7031 WHFPSW            P(4,1)                168D
*RNF7031 WHFSPS            P(4,1)                154D
*RNF7031 WHFSPW            P(4,1)                169D
*RNF7031 WHFTXT            A(50)                 100D
*RNF7031 WHFTYP            A(1)                   85D
*RNF7031 WHHDNCOL          A(1)                  180D
*RNF7031 WHHEX             A(1)                  135D
         WHIBO             P(5,0)                 96D    831     853
*RNF7031 WHIDC             A(1)                  173D
*RNF7031 WHIFPS            P(4,1)                156D
*RNF7031 WHIFPW            P(4,1)                171D
*RNF7031 WHJREF            P(2,0)                119D
*RNF7031 WHJRF2            P(3,0)                179D
*RNF7031 WHLIB             A(10)                  83D
*RNF7031 WHMAP             A(1)                  129D
*RNF7031 WHMAPL            P(5,0)                131D
*RNF7031 WHMAPS            P(5,0)                130D
*RNF7031 WHNAME            A(10)                  88D
*RNF7031 WHNFLD            P(5,0)                114D
*RNF7031 WHNIND            P(2,0)                115D
*RNF7031 WHNRML            A(1)                  178D
*RNF7031 WHNULL            A(1)                  142D
*RNF7031 WHPNTS            P(4,1)                136D
*RNF7031 WHPSUD            A(1)                  166D
*RNF7031 WHRCDE            P(3,0)                101D
*RNF7031 WHRCTS            A(1)                  181D



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     30

*RNF7031 WHRES1            A(2)                  133D
*RNF7031 WHRFIL            A(10)                 102D
*RNF7031 WHRFLD            A(10)                 105D
*RNF7031 WHRFMT            A(10)                 104D
         WHRLEN            P(5,0)                 92D    853
*RNF7031 WHRLIB            A(10)                 103D
*RNF7031 WHRWID            A(1)                  172D
*RNF7031 WHSEP             A(1)                  139D
*RNF7031 WHSEQ             A(13)                  89D
*RNF7031 WHSHFT            A(1)                  116D
*RNF7031 WHSQLT            A(1)                  134D
*RNF7031 WHSYSN            A(8)                  132D
*RNF7031 WHTEXT            A(50)                  90D
*RNF7031 WHTXRT            P(3,0)                151D
*RNF7031 WHVARL            A(1)                  140D
*RNF7031 WHVCNE            P(4,0)                113D
         WRTREC            BEGSR                 350     369     382D

      Indicator References:

         Indicator                            References (D=Defined M=Modified)
*RNF7030 01                                      207     903     914     925
                                                 936
*RNF7030 03                                      198
*RNF7030 06                                      200
*RNF7030 12                                      198
*RNF7030 14                                      204
         51                                      274M    283
         56                                      257M    259M
         80                                      289     317     532M    537M
         81                                      289     318     542M    551M
         82                                      289     319     558M    561M
         89                                      281M    538M    552M    562M
         LR                                      248M

       * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     31

                      E x t e r n a l   R e f e r e n c e s

      Statically bound procedures:
         Procedure                            References
         No references in the source.

      Imported fields:
         Field             Attributes         Defined
         No references in the source.

      Exported fields:
         Field             Attributes         Defined
         No references in the source.

   * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     32

                          M e s s a g e   S u m m a r y

 Msg id  Sv Number Message text
*RNF7031 00    100 The name or indicator is not referenced.
*RNF7066 00      1 Record-Format name of Externally-Described file is not used.
*RNF7089 00      1 RPG provides Separate-Indicator area for file.
*RNF7030 30     74 The name or indicator is not defined.
*RNF7503 30    207 Expression contains an operand that is not defined.
*RNF2120 40      2 External description not found for file specified as
                   externally described; file ignored.

       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *



 5770WDS V7R3M0  160422 RN        IBM ILE RPG             VZRPG_FREE/RGHS_ENT      PASSIST2   08/29/17 11:06:22        Page     33

                            F i n a l   S u m m a r y

  Message Totals:

    Information  (00) . . . . . . . :      102
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :      283
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :      385


  Source Totals:

    Records . . . . . . . . . . . . :      955
    Specifications  . . . . . . . . :      681
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      184

         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
Compilation stopped. Severity 40 errors found in program.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
